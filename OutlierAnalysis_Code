#Outlier Analysis
mean_NAME_OF_DV_COLUMN <- mean(data$DEPENDENT_VARIABLE_COLUMN)
sd_NAME_OF_DV_COLUMN <- sd(data$DEPENDENT_VARIABLE_COLUMN)

mean_NAME_OF_IV_COLUMN <- mean(data$`INDEPENDENT_VARIABLE_COLUMN`)
sd_NAME_OF_IV_COLUMN <- sd(data$`INDEPENDENT_VARIABLE_COLUMN`)

mean_NAME_OF_MODERATOR_COLUMN <- mean(data$MODERATOR_VARIABLE_COLUMN)
sd_NAME_OF_MODERATOR_COLUMN <- sd(data$MODERATOR_VARIABLE_COLUMN)

data$z_DEPENDENT_VARIABLE_COLUMN <- (data$DEPENDENT_VARIABLE_COLUMN - mean_DEPENDENT_VARIABLE_COLUMN) / sd_DEPENDENT_VARIABLE_COLUMN
data$z_INDEPENDENT_VARIABLE_COLUMN <- (data$`INDEPENDENT_VARIABLE_COLUMN` - mean_INDEPENDENT_VARIABLE_COLUMN) / sd_INDEPENDENT_VARIABLE_COLUMN
data$z_MODERATOR_VARIABLE_COLUMN <- (data$MODERATOR_COLUMN - mean_MODERATOR_COLUMN) / sd_MODERATOR_COLUMN

outliers <- data %>%
  filter(z_DEPENDENT_VARIABLE_COLUMN < -2.5 | z_DEPENDENT_VARIABLE_COLUMN > 2.5 |
           z_INDEPENDENT_VARIABLE_COLUMN < -2.5 | z_INDEPENDENT_VARIABLE_COLUMN > 2.5 |
           z_MODERATOR_VARIABLE_COLUMN < -2.5 | z_MODERATOR_VARIABLE_COLUMN > 2.5)

print(outliers)

# This is an optional Export to Excel
install.packages("writexl")
library(writexl)
write_xlsx(outliers, "outliers.xlsx")
